# ECG_HF
高频心电信号分类尝试  
数据量其实比较小，只有177条，但是质量应该还可以，可以多试试。
其中ecg_cnn部分为心律失常代码，判断分为5级，不能直接迁移学习，但可以学习其模型架构  
当前在用普通的cnn进行尝试  
## CNN调参心路
![alt text](cnn/results/start_training_history.png)  
从目前的结果看  
在 epoch 1 后，验证集 accuracy 立即达到 72.22%，但随后同一值培训进入长达 18 轮的直线阶段，显示验证效果已经均衡且无进一步提升。

同时，训练 accuracy 由最初 60.3%一路升至 85.1%，而 loss 持续下降，显示模型正在迟缓地学习近似分类器，但这种学习在验证集无法体现，即表示学习的是训练集中的专有特征，有过学识的倾向。

同时，验证 loss 在 epoch 11 后体现最低值 0.6926 ，随后越来越高，较乎突出地表示一定程度上已经进入过拟合阶段。

test accuracy = val accuracy = 72.22%，表明分组设置并无显著 data leakage，但模型效果地址别性已经形成瓶颈。

### 数据分配

尽管验证集结果稳定，但根据数据量不大，建议重新分割数据或实时采用 K 折交叉验证（K=5或10），可大幅清除模型表现不稳定的偏差。  
本思想是将数据集分成K个子集或“折”（folds），然后进行K次训练和验证，每次选择其中一个不同的折作为验证集，其余的K-1个折合并起来作为训练集。将原始数据集随机分成K个大小大致相等的互斥子集。理想情况下，这些子集应该保持原始数据集的分布特性，特别是对于分类任务时，每个子集中的类别比例应与整个数据集一致，这被称为分层抽样。

当数据量非常小的时候，可能会使用留一法（Leave-One-Out, LOO），即K等于数据集中的样本数

### 优化算法

现有模型 loss 减少速度不错，但验证 loss 进入明显的升高阶段，建议：

将课程下降率从 1e-3 调低至 1e-4，或带入 ReduceLROnPlateau 自动调整课程下降  

### 发现华点
我们的数据并不均衡

因此数据中的类别分布，应该作为模型训练的重要参考。

需要在划分训练集和测试集的时候，对数据集进行重新划分，以平衡数据集。

解决方案，添加类别权重

尝试了，但是效果并没有变好，同时还引入了几个新指标，但没有那么好

